<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Bubu & Dudu "I Miss You" Counter ‚ù§Ô∏è</title>
<style>
  body {
    margin: 0; padding: 0;
    background: linear-gradient(135deg, #f9d6e3, #fcd0d7);
    font-family: 'Comic Sans MS', cursive, sans-serif;
    display: flex; flex-direction: column; align-items: center; justify-content: center;
    height: 100vh;
    color: #900;
  }
  h1 {
    font-size: 2.5rem;
    margin-bottom: 0.5rem;
  }
  #counts {
    font-size: 1.8rem;
    margin: 1rem 0;
    color: #c00;
    letter-spacing: 0.05em;
    text-align: center;
  }
  button#missBtn {
    background: #ff6f91;
    border: none;
    border-radius: 50px;
    padding: 1rem 2.5rem;
    font-size: 1.8rem;
    color: white;
    cursor: pointer;
    box-shadow: 0 5px 15px rgba(255,111,145,0.6);
    transition: all 0.3s ease;
    user-select: none;
  }
  button#missBtn:active {
    transform: scale(0.95);
    box-shadow: 0 3px 10px rgba(255,111,145,0.8);
  }
  #lastPressed {
    margin-top: 1rem;
    font-size: 1.2rem;
    font-style: italic;
    color: #b22;
  }
  #soundToggle {
    margin-top: 2rem;
    background: transparent;
    border: none;
    cursor: pointer;
    font-size: 2rem;
    color: #900;
    user-select: none;
  }
  /* Mobile friendly */
  @media (max-width: 600px) {
    h1 { font-size: 2rem; }
    #counts { font-size: 1.4rem; }
    button#missBtn { font-size: 1.5rem; padding: 0.8rem 2rem; }
  }
</style>
</head>
<body>

<h1>Bubu ‚ù§Ô∏è Dudu</h1>

<div id="counts">
  <div id="prabhavMissed">Bubu missed Dudu: 0</div>
  <div id="duduMissed">Dudu missed Bubu: 0</div>
</div>

<button id="missBtn">I Miss You üíñ</button>

<div id="lastPressed">Waiting for love...</div>

<button id="soundToggle" aria-label="Toggle sound">üîà</button>

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
<script>
  // TODO: Replace with your Firebase config
  const firebaseConfig = {
  apiKey: "AIzaSyAkGwclzyBz5KmetA2dFFDbyjWUYQ3VQno",
  authDomain: "dudu-63a5c.firebaseapp.com",
  databaseURL: "https://dudu-63a5c-default-rtdb.asia-southeast1.firebasedatabase.app",
  projectId: "dudu-63a5c",
  storageBucket: "dudu-63a5c.firebasestorage.app",
  messagingSenderId: "312119934843",
  appId: "1:312119934843:web:14ec7378bf0029d04b47de"
};

  // Initialize Firebase
  firebase.initializeApp(firebaseConfig);
  const db = firebase.database();

  // Elements
  const prabhavMissedElem = document.getElementById('prabhavMissed');
  const duduMissedElem = document.getElementById('duduMissed');
  const missBtn = document.getElementById('missBtn');
  const lastPressedElem = document.getElementById('lastPressed');
  const soundToggle = document.getElementById('soundToggle');

  // Sound setup
  let muted = false;
  let clickSound = new Audio('https://actions.google.com/sounds/v1/alarms/beep_short.ogg');

  // Keys in database for counts
  const prabhavMissedRef = db.ref('prabhavMissedCount');
  const duduMissedRef = db.ref('duduMissedCount');
  const lastUserRef = db.ref('lastUser');

  // Variables to hold counts locally
  let prabhavMissedCount = 0;
  let duduMissedCount = 0;

  // Get or set username once
  let username = localStorage.getItem('username');
  if (!username) {
    // Prompt user once on load for name
    username = prompt("Who are you? Type 'prabhav' or 'dudu'").toLowerCase();
    if (username !== 'prabhav' && username !== 'dudu') username = 'dudu'; // default fallback
    localStorage.setItem('username', username);
  }

  // Update UI counts live from Firebase
  prabhavMissedRef.on('value', snapshot => {
    prabhavMissedCount = snapshot.val() || 0;
    prabhavMissedElem.textContent = `Bubu missed Dudu: ${prabhavMissedCount}`;
  });

  duduMissedRef.on('value', snapshot => {
    duduMissedCount = snapshot.val() || 0;
    duduMissedElem.textContent = `Dudu missed Bubu: ${duduMissedCount}`;
  });

  // Update last pressed info live
  lastUserRef.on('value', snapshot => {
    const lastUser = snapshot.val();
    if (lastUser === 'prabhav') {
      lastPressedElem.textContent = "Last pressed by: Bubu ‚ù§Ô∏è";
    } else if (lastUser === 'dudu') {
      lastPressedElem.textContent = "Last pressed by: Dudu üíï";
    } else {
      lastPressedElem.textContent = "Waiting for love...";
    }
  });

  missBtn.addEventListener('click', () => {
    // If current user is prabhav, increment duduMissedCount (she missed him)
    // If current user is dudu, increment prabhavMissedCount (he missed her)
    if (username === 'prabhav') {
      duduMissedRef.transaction(current => (current || 0) + 1);
      lastUserRef.set('prabhav');
    } else if (username === 'dudu') {
      prabhavMissedRef.transaction(current => (current || 0) + 1);
      lastUserRef.set('dudu');
    }

    if (!muted) {
      clickSound.currentTime = 0;
      clickSound.play();
    }
  });

  soundToggle.addEventListener('click', () => {
    muted = !muted;
    soundToggle.textContent = muted ? 'üîá' : 'üîà';
  });
</script>

</body>
</html>
